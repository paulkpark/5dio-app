<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>5DO Pro</title>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
<link rel="preconnect" href="https://xdjgumqdwedgzwqturcx.supabase.co">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
<style>
:root{
  --bg:#0b0d13; --panel:#12141b; --card:#181b25; --ink:#e5e7eb;
  --muted:#9aa3b7; --border:#222738; --accent:#9cff8b;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,'Noto Sans KR',Roboto,Arial}

/* Header / Tabs / Lang / Hamburger */
header{display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:10px 14px;background:var(--panel);border-bottom:1px solid var(--border);position:relative}
.logo{font-weight:700;color:var(--accent);font-size:1.2rem;margin-left:40px}
.tabs{display:flex;gap:6px}
.tab{padding:4px 8px;font-size:.74rem;border:1px solid var(--border);border-radius:8px;background:#171d2b;color:#cfead1;cursor:pointer}
.tab.active{background:#1f2739;border-color:#334}
.section{display:none}.section.active{display:block}
.lang-toggle{color:#fff;border:1px solid #444;padding:4px 8px;border-radius:6px;cursor:pointer;background:#171d2b}

.menu-container{position:absolute;top:12px;left:10px;z-index:1000}
.menu-button{font-size:24px;color:#fff;cursor:pointer}
.dropdown-menu{display:none;flex-direction:column;position:absolute;background:rgba(0,0,0,0.9);
  padding:8px 10px;border-radius:10px;width:160px}
.dropdown-menu a{color:#fff;padding:6px 10px;text-decoration:none;border-radius:6px}
.dropdown-menu a:hover{background:rgba(255,255,255,0.1)}
.menu-backdrop{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.3);z-index:900}

/* Library */
#oscLib{width:100%;height:120px;background:#090b11;border-bottom:1px solid var(--border);display:block}
#navRow{display:flex;justify-content:center;gap:8px;padding:8px}
.btn{background:#1e2232;border:1px solid #2c3147;color:#eee;border-radius:10px;padding:8px 10px;font-size:1.2rem;cursor:pointer}
.btn:hover{background:#2a3148}
#library{display:flex;overflow-x:auto;gap:10px;padding:10px;scroll-behavior:smooth;scroll-snap-type:x mandatory}
.card{flex:0 0 auto;width:160px;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:6px;scroll-snap-align:start}
.card img{width:100%;aspect-ratio:1/1;object-fit:contain;background:#0f1320;border-radius:8px}

.controls{display:flex;flex-direction:column;gap:12px;padding:12px;background:#0f1320;border-top:1px solid var(--border);border-bottom:1px solid var(--border)}
.statusRow{display:flex;align-items:center;gap:18px}
#statusThumb{width:124px;height:124px;border-radius:16px;background:radial-gradient(circle at center,#1a1f2f 40%,#0d0f18 100%);
  border:1px solid #2d334a;box-shadow:0 0 12px rgba(80,180,255,.15);background-size:cover;background-position:center;position:relative;overflow:hidden}
#statusThumb::before{content:'';position:absolute;inset:0;border-radius:50%;
  background:radial-gradient(circle,rgba(100,200,255,.25),transparent 60%);animation:pulse 2s infinite ease-in-out}
#statusThumb.loaded::before{display:none}
@keyframes pulse{0%,100%{transform:scale(.8);opacity:.5}50%{transform:scale(1.1);opacity:1}}
.ctrlStack{display:flex;flex-direction:column;gap:10px}
.ctrlLine{display:flex;align-items:center;gap:8px}
audio{width:92%;display:block;margin:8px auto}

/* Generator */
.gen-wrap{padding:12px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.field{background:#141a27;border:1px solid #2a3044;border-radius:12px;padding:10px}
.field h4{margin:0 0 8px;color:#dfe7f6;font-size:.95rem}
.field label{display:block;font-size:.85rem;color:#9aa3b7;margin-bottom:4px}
.field input[type="number"],.field select,.field input[type="range"]{
  width:100%;background:#101522;color:#e9eefc;border:1px solid #2a3044;border-radius:8px;padding:6px}
.full{grid-column:1/-1}
.gen-actions{display:flex;gap:10px;align-items:center}
.pill{padding:8px 12px;border-radius:999px;border:1px solid #2c3147;background:#1b2333;color:#e9eefc;cursor:pointer}
.pill.primary{background:#21324e;border-color:#355;color:#cfead1}
#oscGen{width:100%;height:140px;background:#0a0d14;border:1px solid #20263a;border-radius:12px;margin-top:12px}

@media (max-width:640px){ .grid{grid-template-columns:1fr} }
</style>
</head>
<body>

<!-- Hamburger -->
<div class="menu-container">
  <div id="menuButton" class="menu-button">‚ò∞</div>
  <div id="dropdownMenu" class="dropdown-menu">
    <a href="https://5dshop.co.kr" target="_blank">Shop</a>
    <a href="#">FAQ</a><a href="#">Manual</a><a href="#">Contact</a><a href="#">About</a>
  </div>
  <div id="menuBackdrop" class="menu-backdrop"></div>
</div>

<header>
  <div class="logo">5DO Pro</div>
  <div class="tabs">
    <div class="tab active" data-tab="lib">5DO</div>
    <div class="tab" data-tab="gen">Freq. Gen.</div>
  </div>
  <button id="langToggle" class="lang-toggle">EN</button>
</header>

<!-- Library oscilloscope -->
<canvas id="oscLib"></canvas>

<section id="section-lib" class="section active" aria-label="Library">
  <div id="navRow">
    <button id="btnBack" class="btn" title="Back">‚¨ÖÔ∏è</button>
    <button id="btnRefresh" class="btn" title="Refresh">üîÑ</button>
    <button id="btnSaveList" class="btn" title="Save Playlist">üíæ</button>
    <button id="btnLoadList" class="btn" title="Load Playlist">üìú</button>
  </div>

  <div id="library"></div>

  <div class="controls">
    <div class="statusRow">
      <div id="statusThumb"></div>
      <div class="ctrlStack">
        <div class="ctrlLine">
          <label for="vol" id="lblVol">Volume</label>
          <input id="vol" type="range" min="0" max="1" step="0.01" value="1">
        </div>
        <div class="ctrlLine">
          <label><input type="checkbox" id="loop"> <span id="lblLoop">Loop</span></label>
        </div>
        <div class="ctrlLine">
          <label for="timer" id="lblTimer">Timer</label>
          <select id="timer">
            <option value="0">Off</option><option value="5">5 min</option>
            <option value="10">10 min</option><option value="15">15 min</option>
            <option value="20">20 min</option><option value="30">30 min</option>
            <option value="45">45 min</option><option value="60">60 min</option>
          </select>
        </div>
      </div>
    </div>
    <audio id="player" controls preload="none" playsinline controlslist="nodownload noplaybackrate"></audio>
  </div>
</section>

<section id="section-gen" class="section" aria-label="Generator">
  <div class="gen-wrap">
    <div class="grid">
      <div class="field">
        <h4>Waveform</h4>
        <select id="genWave">
          <option value="sine">Sine</option>
          <option value="square">Square</option>
          <option value="sawtooth">Saw</option>
          <option value="triangle">Triangle</option>
        </select>
      </div>
      <div class="field">
        <h4>Level</h4>
        <input id="genLevel" type="range" min="0" max="1" step="0.01" value="0.5">
      </div>
      <div class="field">
        <h4>Frequency (Hz)</h4>
        <input id="genFreq" type="number" min="1" max="24000" step="0.1" value="440">
      </div>
      <div class="field">
        <h4>Binaural Beat</h4>
        <label><input id="genBinaural" type="checkbox"> Enable</label>
        <label for="genBeat">Difference (Hz)</label>
        <input id="genBeat" type="number" min="0" max="1000" step="0.1" value="7">
      </div>

      <div class="field full">
        <div class="gen-actions">
          <button id="genStart" class="pill primary" title="Play">‚ñ∂Ô∏è</button>
          <button id="genStop"  class="pill"          title="Stop">‚èπÔ∏è</button>
          <button id="btnSavePreset" class="pill" title="Save Preset">üíæ Save</button>
          <button id="btnLoadPreset" class="pill" title="Load Preset">üîÅ Load</button>
        </div>
        <!-- Generator oscilloscope: Îã® ÌïòÎÇòÎßå -->
        <canvas id="oscGen"></canvas>
      </div>
    </div>
  </div>
</section>

<script>
/* ========== Hamburger ========== */
const menuBtn = document.getElementById("menuButton");
const menu = document.getElementById("dropdownMenu");
const backdrop = document.getElementById("menuBackdrop");
menuBtn.onclick = ()=>{ const o = menu.style.display==="flex"; menu.style.display=o?"none":"flex"; backdrop.style.display=o?"none":"block"; };
backdrop.onclick = ()=>{ menu.style.display="none"; backdrop.style.display="none"; };

/* ========== Tabs ========== */
const tabs = document.querySelectorAll(".tab");
tabs.forEach(t=>t.onclick=()=>{
  tabs.forEach(x=>x.classList.remove("active"));
  t.classList.add("active");
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById("section-"+t.dataset.tab).classList.add("active");
  if (t.dataset.tab==="gen") player.pause(); // Ï†úÎÑàÎ†àÏù¥ÌÑ∞ ÌÉ≠ Îì§Ïñ¥Í∞à Îïå ÎùºÏù¥Î∏åÎü¨Î¶¨ Ïû¨ÏÉù Î©àÏ∂§
});

/* ========== Supabase ========== */
const SUPABASE_URL="https://xdjgumqdwedgzwqturcx.supabase.co";
const SUPABASE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhkamd1bXFkd2VkZ3p3cXR1cmN4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1MDQzNDUsImV4cCI6MjA3NjA4MDM0NX0.pZcnU1xMaaBBdvytSTVrLPsLU9r_3FPzCPSUeBFUsaU";
const BUCKET="media";
const sb = supabase.createClient(SUPABASE_URL,SUPABASE_KEY);
const PUBLIC = SUPABASE_URL.replace(/\/+$/,'') + "/storage/v1/object/public/" + BUCKET + "/";
const RENDER = SUPABASE_URL.replace(/\/+$/,'') + "/storage/v1/render/image/public/" + BUCKET + "/";
const enc = p => p.split("/").filter(Boolean).map(encodeURIComponent).join("/");
const abs = p => PUBLIC + enc(p);
const imgx = (p,query="") => RENDER + enc(p) + (query?("?"+query):"");

/* === Cache buster (ÏÑ∏ÏÖò Îã®ÏúÑ) === */
window.__MEDIA_REV = Date.now();
const bust = (u)=> u + (u.includes('?') ? '&' : '?') + 'v=' + window.__MEDIA_REV;

/* ========== Audio pipeline (singleton & resume) ========== */
const audioCtx = window.audioCtx || new (window.AudioContext||window.webkitAudioContext)();
window.audioCtx = audioCtx;
function unlockAudio(){ if(audioCtx.state!=="running") audioCtx.resume().catch(()=>{}); }
['pointerdown','touchstart','keydown'].forEach(ev => document.addEventListener(ev, unlockAudio, { once:true }));

const player = document.getElementById("player");
player.crossOrigin = "anonymous";

if (!window._audio) {
  const masterGain = audioCtx.createGain(); masterGain.connect(audioCtx.destination);
  const mediaSrc   = audioCtx.createMediaElementSource(player); mediaSrc.connect(masterGain);
  const analyserLib= audioCtx.createAnalyser(); masterGain.connect(analyserLib);
  analyserLib.fftSize = 2048;
  window._audio = { masterGain, mediaSrc, analyserLib };
}
player.addEventListener("play", unlockAudio);

/* Library oscilloscope (player output) */
(function libScope(){
  const cvs = document.getElementById("oscLib"); const ctx = cvs.getContext("2d");
  const buf = new Uint8Array(window._audio.analyserLib.fftSize);
  function resize(){ cvs.width = cvs.clientWidth || window.innerWidth; cvs.height = 120; }
  resize(); window.addEventListener("resize", resize);
  (function draw(){
    requestAnimationFrame(draw);
    window._audio.analyserLib.getByteTimeDomainData(buf);
    ctx.fillStyle="#090b11"; ctx.fillRect(0,0,cvs.width,cvs.height);
    ctx.lineWidth=2; ctx.strokeStyle="#9cff8b"; ctx.beginPath();
    const dx=cvs.width/buf.length;
    for(let i=0,x=0;i<buf.length;i++,x+=dx){
      const y=(buf[i]/128)*(cvs.height/2);
      i?ctx.lineTo(x,y):ctx.moveTo(x,y);
    }
    ctx.lineTo(cvs.width,cvs.height/2); ctx.stroke();
  })();
})();

/* ========== Library Browser ========== */
const lib = document.getElementById("library");
const btnBack = document.getElementById("btnBack");
const btnRefresh = document.getElementById("btnRefresh");
const statusThumb = document.getElementById("statusThumb");
let cwd = "";

/* Ìè¥Îçî/ÌååÏùº ÎÇòÏó¥ */
async function list(p=""){
  const {data,error} = await sb.storage.from(BUCKET).list(p,{limit:1000,sortBy:{column:"name",order:"asc"}});
  if(error){ console.warn("[list]",error); return []; }
  return data||[];
}

function setStatus(img){
  if(!img){
    statusThumb.classList.remove('loaded');
    statusThumb.style.background="radial-gradient(circle at center,#1a1f2f 40%,#0d0f18 100%)";
    statusThumb.style.boxShadow="0 0 12px rgba(80,180,255,.15)";
    statusThumb.style.border="1px solid #2d334a";
    statusThumb.style.backgroundImage="";
  }else{
    statusThumb.classList.add('loaded');
    statusThumb.style.background="none"; statusThumb.style.boxShadow="none";
    statusThumb.style.border="1px solid rgba(255,255,255,.12)";
    statusThumb.style.backgroundImage=`url('${img}')`;
    statusThumb.style.backgroundSize="cover"; statusThumb.style.backgroundPosition="center";
  }
}

async function load(p=""){
  cwd = p; lib.innerHTML = ""; setStatus("");
  const items = await list(p);

  for (const e of items){
    const name = e.name; const full = (p?p+"/":"")+name;

    /* Ìè¥Îçî Ïπ¥Îìú */
    if (!name.includes(".")){
      const card=document.createElement("div"); card.className="card"; card.dataset.kind="folder"; card.dataset.path=full;
      const img=document.createElement("img"); img.loading="lazy";
      // folder.png ‚Üí Ï∫êÏãú Î≤ÑÏä§ÌÑ∞ Ìè¨Ìï®, imgproxyÎ°ú Î¶¨ÏÇ¨Ïù¥Ï¶à (Í∞ÄÎ≥çÍ≥† Îπ†Î¶Ñ)
      img.src=bust(imgx(full+"/folder.png","width=360&quality=70&format=webp"));
      img.onerror=()=>img.src="https://placehold.co/300x300/111/aaa?text=Folder";
      card.onclick=()=>{ unlockAudio(); load(full); };
      card.append(img); lib.append(card);
      continue;
    }

    /* ÏùåÏõê Ïπ¥Îìú */
    if (/\.(mp3|wav|ogg|m4a|flac|aac)$/i.test(name)){
      const card=document.createElement("div"); card.className="card"; card.dataset.kind="audio"; card.dataset.path=full;
      // ÏùåÏõê Ïç∏ÎÑ§Ïùº png (Í∞ôÏùÄ Ïù¥Î¶Ñ).png ‚Üí bust Ï†ÅÏö©
      const png = full.replace(/\.[^.]+$/,".png");
      const thumbUrl = bust(imgx(png, "width=360&quality=70&format=webp"));
      const img=document.createElement("img"); img.loading="lazy"; img.src=thumbUrl;
      img.onerror=()=>img.src="https://placehold.co/300x300/222/888?text=Audio";
      // ÌÅ¥Î¶≠ Ïãú 'Î°úÎìúÎßå' (ÏûêÎèôÏû¨ÏÉù Í∏àÏßÄ) + ÏÉÅÌÉú Ïç∏ÎÑ§ÏùºÎèÑ bust Î∞òÏòÅ
      card.onclick=()=>{
        unlockAudio();
        player.pause(); player.currentTime=0;
        player.src = abs(full);         // Ïò§ÎîîÏò§Îäî Íµ≥Ïù¥ Ï∫êÏãúÎ≤ÑÏä§Ìä∏ Î∂àÌïÑÏöî(ÏÑ±Îä•)
        setStatus(thumbUrl);            // ÏÉÅÌÉú Ïç∏ÎÑ§ÏùºÏùÄ bust Ï†ÅÏö©
      };
      card.append(img); lib.append(card);
    }
  }
}

btnBack.onclick = ()=>{ if(!cwd) return; const a=cwd.split('/'); a.pop(); load(a.join('/')); };
btnRefresh.onclick = ()=> load(cwd);

/* drag-to-scroll */
let isDown=false,sx=0,sl=0;
lib.addEventListener('mousedown',e=>{isDown=true;sx=e.pageX;sl=lib.scrollLeft;});
['mouseleave','mouseup'].forEach(ev=>lib.addEventListener(ev,()=>{isDown=false;}));
lib.addEventListener('mousemove',e=>{if(!isDown) return; lib.scrollLeft = sl - (e.pageX - sx)*1.5;});

/* Ï¥àÍ∏∞ Î£®Ìä∏ Î°úÎìú */
load("");

/* ========== Playlist (localStorage) ========== */
const btnSaveList = document.getElementById("btnSaveList");
const btnLoadList = document.getElementById("btnLoadList");
btnSaveList.onclick = ()=>{
  const name = prompt(isKo?"ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏ Ïù¥Î¶Ñ?":"Playlist name?"); if(!name) return;
  const items = [...lib.querySelectorAll(".card")].filter(c=>c.dataset.kind==="audio")
    .map(c=>({path:c.dataset.path, thumb:c.dataset.path.replace(/\.[^.]+$/,".png")}));
  const all = JSON.parse(localStorage.getItem("playlists")||"{}"); all[name]=items;
  localStorage.setItem("playlists", JSON.stringify(all));
  alert((isKo?"Ï†ÄÏû•Îê®: ":"Saved: ")+name);
};
btnLoadList.onclick = ()=>{
  const all = JSON.parse(localStorage.getItem("playlists")||"{}");
  const names = Object.keys(all); if(!names.length){ alert(isKo?"ÌîåÎ†àÏù¥Î¶¨Ïä§Ìä∏Í∞Ä ÏóÜÏäµÎãàÎã§.":"No playlists found."); return; }
  const sel = prompt((isKo?"ÏÑ†ÌÉù: ":"Select: ")+"\n"+names.join("\n")); if(!sel||!all[sel]) return;
  lib.innerHTML=""; setStatus("");
  all[sel].forEach(({path,thumb})=>{
    const c=document.createElement("div"); c.className="card"; c.dataset.kind="audio"; c.dataset.path=path;
    const t=bust(imgx(thumb,"width=360&quality=70&format=webp"));
    const img=document.createElement("img"); img.loading="lazy"; img.src=t;
    img.onerror=()=>img.src="https://placehold.co/300x300/222/888?text=Audio";
    c.onclick=()=>{ unlockAudio(); player.pause(); player.currentTime=0; player.src=abs(path); setStatus(t); };
    c.append(img); lib.append(c);
  });
};

/* ========== Volume / Loop / Timer ========== */
const vol = document.getElementById("vol");
const loopChk = document.getElementById("loop");
const timerSel = document.getElementById("timer");
let desiredGain = parseFloat(vol.value||"1");
window._audio.masterGain.gain.value = desiredGain;
vol.addEventListener("input",()=>{ desiredGain = +vol.value; if(!player.muted) window._audio.masterGain.gain.value = desiredGain; });
player.addEventListener("volumechange",()=>{ window._audio.masterGain.gain.value = player.muted ? 0 : desiredGain; });
player.loop = loopChk.checked; loopChk.onchange = ()=> player.loop = loopChk.checked;
let timerId=null; timerSel.onchange=()=>{ if(timerId) clearTimeout(timerId); const m=+timerSel.value;
  if(m>0) timerId=setTimeout(()=>{ player.pause(); player.currentTime=0; alert(`Playback stopped after ${m} minutes.`); }, m*60000); };

/* ========== Generator (single oscilloscope) ========== */
const genStart = document.getElementById("genStart");
const genStop  = document.getElementById("genStop");
const waveSel  = document.getElementById("genWave");
const freqInp  = document.getElementById("genFreq");
const lvlInp   = document.getElementById("genLevel");
const bbChk    = document.getElementById("genBinaural");
const beatInp  = document.getElementById("genBeat");

/* Ïò§ÎîîÏò§ ÎùºÏö∞ÌåÖ: Generator ‚Üí masterGain */
const genGain = (function(){ const g = audioCtx.createGain(); g.connect(window._audio.masterGain); return g; })();
let genNodes = [], genRunning=false;

function stopGenerator(){ if(!genRunning) return;
  genNodes.forEach(n=>{try{n.stop&&n.stop()}catch{} try{n.disconnect&&n.disconnect()}catch{}});
  genNodes=[]; genRunning=false; genGain.gain.setTargetAtTime(0,audioCtx.currentTime,0.02);
}
function startGenerator(){
  unlockAudio();
  if(!player.paused) player.pause();
  if(genRunning) stopGenerator();
  const wave=waveSel.value, freq=parseFloat(freqInp.value||"440"), lvl=parseFloat(lvlInp.value||"0.5");
  const useBB=!!bbChk.checked, beat=parseFloat(beatInp.value||"7");
  genGain.gain.value=lvl;
  if(useBB){
    const l=audioCtx.createOscillator(), r=audioCtx.createOscillator();
    l.type=wave; r.type=wave; l.frequency.value=freq; r.frequency.value=freq+beat;
    try{
      const pl=audioCtx.createStereoPanner(), pr=audioCtx.createStereoPanner();
      pl.pan.value=-1; pr.pan.value=+1; l.connect(pl).connect(genGain); r.connect(pr).connect(genGain);
      genNodes=[l,r,pl,pr];
    }catch{ l.connect(genGain); r.connect(genGain); genNodes=[l,r]; }
    l.start(); r.start();
  }else{
    const o=audioCtx.createOscillator(); o.type=wave; o.frequency.value=freq; o.connect(genGain); o.start(); genNodes=[o];
  }
  genRunning=true;
}
genStart.addEventListener("click", startGenerator);
genStop .addEventListener("click",  stopGenerator);

/* Îã®Ïùº Generator Ïò§Ïã§Î°úÏä§ÏΩîÌîÑ - Ï§ëÎ≥µ ÏóÜÏùå */
(function genScope(){
  const cvs = document.getElementById("oscGen"); const ctx = cvs.getContext("2d");
  const analyserGen = audioCtx.createAnalyser(); genGain.connect(analyserGen);
  analyserGen.fftSize = 2048; const buf = new Uint8Array(analyserGen.fftSize);
  function resize(){ cvs.width = cvs.clientWidth || window.innerWidth; cvs.height = 140; }
  resize(); window.addEventListener("resize", resize);
  (function draw(){
    requestAnimationFrame(draw);
    analyserGen.getByteTimeDomainData(buf);
    ctx.fillStyle="#0a0d14"; ctx.fillRect(0,0,cvs.width,cvs.height);
    ctx.lineWidth=2; ctx.strokeStyle="#77d0ff"; ctx.beginPath();
    const dx=cvs.width/buf.length;
    for(let i=0,x=0;i<buf.length;i++,x+=dx){
      const y=(buf[i]/128)*(cvs.height/2);
      i?ctx.lineTo(x,y):ctx.moveTo(x,y);
    }
    ctx.lineTo(cvs.width,cvs.height/2); ctx.stroke();
  })();
})();

/* ========== EN/KO Toggle ========== */
const langBtn = document.getElementById("langToggle"); let isKo=false;
function applyLang(){
  document.getElementById("lblVol").textContent = isKo ? "Î≥ºÎ•®" : "Volume";
  document.getElementById("lblLoop").textContent = isKo ? "Î∞òÎ≥µ" : "Loop";
  document.getElementById("lblTimer").textContent= isKo ? "ÌÉÄÏù¥Î®∏" : "Timer";
  document.querySelector('.tab[data-tab="lib"]').textContent = isKo ? "5DO" : "5DO";
  document.querySelector('.tab[data-tab="gen"]').textContent = isKo ? "Ï£ºÌååÏàò ÏÉùÏÑ±Í∏∞" : "Freq. Gen.";
  const sel = document.getElementById("timer");
  const en = ["Off","5 min","10 min","15 min","20 min","30 min","45 min","60 min"];
  const ko = ["ÎÅî","5Î∂Ñ","10Î∂Ñ","15Î∂Ñ","20Î∂Ñ","30Î∂Ñ","45Î∂Ñ","60Î∂Ñ"];
  sel.querySelectorAll("option").forEach((o,i)=>o.textContent=isKo?ko[i]:en[i]);
}
langBtn.onclick=()=>{ isKo=!isKo; langBtn.textContent=isKo?"KO":"EN"; applyLang(); };
applyLang();
</script>
</body>
</html>
